///<summary>
/*
     Include in .cshtml files where password validation is required
     requires below password input field: <span id="invalidChar" style="color: red; display: none;"></span> 

typical implementation:
-----------------------
<div class="form-group">
    @Html.LabelFor(m => m.Password, new { @class = "control-label required-field" })

    @Html.PasswordFor(m => m.Password, new { @class = "form-control", required = "required" })
    @Html.ValidationMessageFor(m => m.Password)
    <span id="invalidChar" style="color: red; display: none;"></span>
    <span id="spPwdMsg" style="color: blue;">
        <br />
        The password must use at least three of the four available character types: <br />
    </span>
    <span id="spMinLen" class="pwdvalidrule">* must be at least 8 characters long,</span> <br />
    <span id="spLcase" class="pwdvalidrule">* lowercase letters (a through z),</span> <br />
    <span id="spUcase" class="pwdvalidrule">* uppercase letters (A through Z),</span> <br />
    <span id="spDigit" class="pwdvalidrule">* numbers (0 through 9), and</span><br />
    <span id="spSpecial" class="pwdvalidrule">* special characters(! &#64; # $ % ^ & + = ? ~ - _ { } [ ] / . \ | : ; )</span>.
</div>
*/
///</summary>

function validatePassword(_password) {

    var LegitCharCount = 0;
    var hasUChar = false;
    var hasLChar = false;
    var hasDigit = false;
    var hasSpChar = false;
    var hasMinLen = false;
    let minLenPattern = /^.{8,}$/;
    let digitPattern = /^\d+$/;
    let spCharPattern = '^(()!#$%^&+=?~-_{}[]/.\|:;)$';
    let lowerCasePattern = /^[a-z]+$/;
    let upperCasePattern = /^[A-Z]+$/;

    if (minLenPattern.test(_password)) {
        hasMinLen = true;
    }

    for (var i = 0; i < _password.length; i++) {
        var char = _password.charAt(i);

        if (digitPattern.test(char)) {
            LegitCharCount += (hasDigit) ? 0 : 1;
            hasDigit = true;
        }
        else if (spCharPattern.indexOf(char) !== -1) {
            LegitCharCount += (hasSpChar) ? 0 : 1;
            hasSpChar = true;
        }
        else if (upperCasePattern.test(char)) {
            LegitCharCount += (hasUChar) ? 0 : 1;
            hasUChar = true;
        }
        else if (lowerCasePattern.test(char)) {
            LegitCharCount += (hasLChar) ? 0 : 1;
            hasLChar = true;
        }
        else {
            $("#invalidChar").html('<br />Invalid character: ' + char);
            $("#invalidChar").show();
            return false;
        };
    }

    //apply css
    if (hasMinLen) {
        
        $("#spMinLen").removeClass('pwdinvalidrule');
        $("#spMinLen").addClass('pwdvalidrule');
    } else {
        $("#spMinLen").addClass('pwdinvalidrule');
        $("#spMinLen").removeClass('pwdvalidrule');
    }

    if (hasDigit) {
        $("#spDigit").removeClass('pwdinvalidrule');
        $("#spDigit").addClass('pwdvalidrule');
    } else {
        $("#spDigit").addClass('pwdinvalidrule');
        $("#spDigit").removeClass('pwdvalidrule');
    }

    if (hasUChar) {
        $("#spUcase").removeClass('pwdinvalidrule');
        $("#spUcase").addClass('pwdvalidrule');
    } else {
        $("#spUcase").addClass('pwdinvalidrule');
        $("#spUcase").removeClass('pwdvalidrule');
    }

    if (hasLChar) {
        $("#spLcase").removeClass('pwdinvalidrule');
        $("#spLcase").addClass('pwdvalidrule');
    } else {
        $("#spLcase").addClass('pwdinvalidrule');
        $("#spLcase").removeClass('pwdvalidrule');
    }

    if (hasSpChar) {
        $("#spSpecial").removeClass('pwdinvalidrule');
        $("#spSpecial").addClass('pwdvalidrule');
    } else {
        $("#spSpecial").addClass('pwdinvalidrule');
        $("#spSpecial").removeClass('pwdvalidrule');
    }

    if (LegitCharCount >= 3 && hasMinLen) {
        $("#spMinLen").removeClass('pwdinvalidrule');
        $("#spDigit").removeClass('pwdinvalidrule');
        $("#spUcase").removeClass('pwdinvalidrule');
        $("#spLcase").removeClass('pwdinvalidrule');
        $("#spSpecial").removeClass('pwdinvalidrule');

        $("#spMinLen").addClass('pwdvalidrule');
        $("#spDigit").addClass('pwdvalidrule');
        $("#spUcase").addClass('pwdvalidrule');
        $("#spLcase").addClass('pwdvalidrule');
        $("#spSpecial").addClass('pwdvalidrule');

        return true;
    }
    
    return false;
}